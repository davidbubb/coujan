:root{
  --bg: #F6F4EE;
  --card-bg: #ffffff;
  --muted: #6b7680;
  --accent: #A7E7E1;
  --text-primary: #1f2933;
  --text-secondary: #24303a;
  --border-color: #E6E9EB;
  --shadow: rgba(30,40,50,0.08);
  --radius: 14px;
  --max-width: 720px;
  --font-sans: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
  --font-cjk: "Noto Sans CJK SC", "Noto Sans CJK TC", system-ui;
}

/* Dark Mode */
body.theme-dark {
  --bg: #1a1d23;
  --card-bg: #242832;
  --muted: #9ca3af;
  --accent: #5eead4;
  --text-primary: #e5e7eb;
  --text-secondary: #d1d5db;
  --border-color: #374151;
  --shadow: rgba(0,0,0,0.3);
}

body.theme-dark {
  background: linear-gradient(180deg, var(--bg), #0f1115);
}

body.theme-dark .card {
  box-shadow: 0 10px 40px var(--shadow), 0 2px 8px rgba(0,0,0,0.2);
}

body.theme-dark .chars {
  color: var(--text-primary);
}

body.theme-dark .translation {
  color: var(--text-secondary);
}

body.theme-dark .play,
body.theme-dark .controls button {
  background: #2d3340;
  border-color: var(--border-color);
  color: var(--text-primary);
}

body.theme-dark .play:hover,
body.theme-dark .controls button:hover {
  background: #363c4a;
  border-color: var(--accent);
}

body.theme-dark::before {
  background: linear-gradient(120deg, rgba(94,234,212,0.15), rgba(139,92,246,0.12) 45%, rgba(236,72,153,0.1));
  opacity: 0.3;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:var(--font-sans);
  background: linear-gradient(180deg,var(--bg), #FBFBFA);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
}

.app{width:100%;max-width:var(--max-width)}
.card{
  background:var(--card-bg);
  border-radius:var(--radius);
  padding: 28px 32px;
  box-shadow: 0 8px 30px var(--shadow), 0 2px 8px rgba(30,40,50,0.04);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  border: 1px solid rgba(0,0,0,0.02);
}

.card:hover {
  transform: translateY(-2px);
  box-shadow: 0 12px 40px var(--shadow), 0 4px 12px rgba(30,40,50,0.06);
}

/* languages columns */
.languages{
  display:flex;
  gap:12px;
  align-items:stretch;
}
.col{
  flex:1;
  text-align:center;
  padding:12px;
}
.label{
  font-size:12px;
  color:var(--muted);
  margin-bottom:8px;
}
.chars{
  font-family:var(--font-cjk);
  font-size:38px;
  line-height:1.2;
  color:var(--text-primary);
  margin-bottom:12px;
  font-weight: 500;
  letter-spacing: 0.02em;
}
.romanization{
  color:var(--muted);
  font-size:14px;
  margin-bottom:8px;
}
.play{
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  padding: 10px 14px;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.2s ease;
  color: var(--text-primary);
  font-size: 14px;
  font-weight: 500;
}

.play:hover {
  background: var(--accent);
  border-color: var(--accent);
  transform: scale(1.05);
}

/* English translation underneath spanning both columns */
.english{
  margin-top:18px;
  text-align:center;
}
.translation{
  font-size:20px;
  color:var(--text-secondary);
  font-weight:600;
  line-height: 1.4;
}
.context{
  font-size:13px;
  color:var(--muted);
  margin-top:6px;
}

/* controls */
.controls{
  display: flex;
  gap: 12px;
  justify-content: center;
  margin-top: 20px;
}

.controls button{
  padding: 10px 18px;
  border-radius: 10px;
  border: 1px solid var(--border-color);
  background: var(--card-bg);
  color: var(--text-primary);
  cursor: pointer;
  transition: all 0.2s ease;
  font-weight: 500;
  font-size: 14px;
}

.controls button:hover {
  background: var(--accent);
  border-color: var(--accent);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.controls button:active {
  transform: translateY(0);
}

/* responsive: stack columns on narrow screens */
@media (max-width:540px){
  .languages{flex-direction:column}
  .chars{font-size:44px}
}

/* ambient animated background (more visible) */
body{position:relative;overflow:hidden}
body::before{
  content:"";
  position:absolute;
  inset:-25%;
  background: linear-gradient(120deg, rgba(167,231,225,1), rgba(198,210,255,0.96) 45%, rgba(255,228,220,0.95));
  background-size:200% 200%;
  filter: blur(24px) saturate(115%);
  opacity:0.52;
  z-index:-2;
  will-change:background-position,transform,opacity;
  animation:gradientShift 30s ease-in-out infinite;
  pointer-events:none;
}
body::after{
  content:"";
  position:absolute;
  inset:-35%;
  background: radial-gradient(circle at 10% 18%, rgba(255,255,255,0.10), transparent 18%),
              radial-gradient(circle at 82% 82%, rgba(255,248,240,0.08), transparent 22%);
  z-index:-1;
  opacity:0.72;
  transform-origin:center;
  will-change:transform,opacity;
  animation:gentleFloat 26s ease-in-out infinite;
  pointer-events:none;
}
/* subtle breathing overlay on the card for depth */
.app,.card{position:relative;z-index:1}
.card::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius:inherit;
  background: linear-gradient(135deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
  z-index:0;
  pointer-events:none;
  transform-origin:center;
  will-change:transform,opacity;
  animation:cardBreath 18s ease-in-out infinite;
}
@keyframes gradientShift{
  0%{background-position:0% 50%;transform:scale(1)}
  50%{background-position:100% 50%;transform:scale(1.01)}
  100%{background-position:0% 50%;transform:scale(1)}
}
@keyframes gentleFloat{
  0%{transform:translate3d(-2%,-1%,0) scale(1);opacity:0.65}
  50%{transform:translate3d(2%,1%,0) scale(1.02);opacity:0.78}
  100%{transform:translate3d(-2%,-1%,0) scale(1);opacity:0.65}
}
@keyframes cardBreath{
  0%{transform:scale(1);opacity:0.95}
  50%{transform:scale(1.01);opacity:1}
  100%{transform:scale(1);opacity:0.95}
}
/* theme toggle button */
.theme-toggle {
  position: fixed;
  top: 20px;
  right: 20px;
  background: var(--card-bg);
  border: 1px solid var(--border-color);
  border-radius: 50%;
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  box-shadow: 0 4px 12px var(--shadow);
  transition: all 0.2s ease;
  z-index: 100;
}

.theme-toggle:hover {
  transform: scale(1.1);
  box-shadow: 0 6px 16px var(--shadow);
}

/* theme controls */
.theme-controls {
  display: flex;
  gap: 8px;
  justify-content: center;
  margin-top: 20px;
  padding-top: 20px;
  border-top: 1px solid var(--border-color);
}

.theme-btn {
  padding: 8px 14px;
  border-radius: 8px;
  border: 1px solid var(--border-color);
  background: var(--card-bg);
  color: var(--text-primary);
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 13px;
  font-weight: 500;
}

.theme-btn:hover {
  border-color: var(--accent);
  background: rgba(167, 231, 225, 0.1);
}

.theme-btn.active {
  background: var(--accent);
  border-color: var(--accent);
  color: #1f2933;
  font-weight: 600;
}

body.theme-dark .theme-btn.active {
  color: #0f1115;
}

/* reduced motion support */
@media (prefers-reduced-motion: reduce){
  body::before,body::after,.card::before{animation:none;opacity:0.35;filter:blur(18px)}
  *{animation:none!important;transition:none!important}
  .card:hover, .play:hover, .controls button:hover, .theme-toggle:hover {
    transform: none;
  }
}

/* Responsive Design */
@media (max-width: 768px) {
    body {
        flex-direction: column;
        padding: 20px;
    }
    .card {
        width: 100%;
        margin: 10px 0;
    }
}

/* Typography Improvements */
body {
    font-size: 16px;
    line-height: 1.5;
}

h1, h2, h3 {
    font-weight: 600;
    margin: 0;
}

h1 {
    font-size: 2em;
}

h2 {
    font-size: 1.5em;
}

h3 {
    font-size: 1.2em;
}

/* Controls at top of card */
.controls-top {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 12px;
  margin-bottom: 20px;
  flex-wrap: wrap;
}

.left-controls {
  display: flex;
  align-items: center;
  gap: 12px;
  flex-wrap: wrap;
}

.left-controls .small {
  font-size: 12px;
  color: var(--muted);
  white-space: nowrap;
}

.left-controls select {
  padding: 6px 10px;
  border-radius: 8px;
  border: 1px solid var(--border-color);
  background: var(--card-bg);
  color: var(--text-primary);
  font-size: 13px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.left-controls select:hover {
  border-color: var(--accent);
}

.left-controls input[type="checkbox"] {
  cursor: pointer;
  margin-right: 4px;
}

.right-controls {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.fav, .animation-toggle {
  padding: 8px 12px;
  border-radius: 8px;
  border: 1px solid var(--border-color);
  background: var(--card-bg);
  color: var(--text-primary);
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 13px;
  font-weight: 500;
  white-space: nowrap;
  min-height: 44px;
}

.fav:hover, .animation-toggle:hover {
  border-color: var(--accent);
  background: rgba(167, 231, 225, 0.1);
}

.fav[aria-pressed="true"] {
  background: var(--accent);
  border-color: var(--accent);
  color: #1f2933;
}

/* Additional theme color schemes */
body.theme-ocean {
  --bg: #e0f2f7;
  --card-bg: #ffffff;
  --muted: #607d8b;
  --accent: #00bcd4;
  --text-primary: #0d47a1;
  --text-secondary: #1565c0;
  --border-color: #b3e5fc;
  --shadow: rgba(0, 188, 212, 0.15);
}

body.theme-ocean {
  background: linear-gradient(180deg, #e0f2f7, #b3e5fc);
}

body.theme-ocean::before {
  background: linear-gradient(120deg, rgba(0,188,212,0.3), rgba(3,169,244,0.25) 45%, rgba(100,181,246,0.2));
  opacity: 0.5;
}

body.theme-sunset {
  --bg: #fff3e0;
  --card-bg: #ffffff;
  --muted: #8d6e63;
  --accent: #ff9800;
  --text-primary: #e65100;
  --text-secondary: #f57c00;
  --border-color: #ffe0b2;
  --shadow: rgba(255, 152, 0, 0.15);
}

body.theme-sunset {
  background: linear-gradient(180deg, #fff3e0, #ffccbc);
}

body.theme-sunset::before {
  background: linear-gradient(120deg, rgba(255,152,0,0.3), rgba(255,112,67,0.25) 45%, rgba(239,83,80,0.2));
  opacity: 0.5;
}

body.theme-purple {
  --bg: #f3e5f5;
  --card-bg: #ffffff;
  --muted: #7e57c2;
  --accent: #ab47bc;
  --text-primary: #4a148c;
  --text-secondary: #6a1b9a;
  --border-color: #e1bee7;
  --shadow: rgba(171, 71, 188, 0.15);
}

body.theme-purple {
  background: linear-gradient(180deg, #f3e5f5, #e1bee7);
}

body.theme-purple::before {
  background: linear-gradient(120deg, rgba(171,71,188,0.3), rgba(126,87,194,0.25) 45%, rgba(149,117,205,0.2));
  opacity: 0.5;
}

body.theme-neon {
  --bg: #1a1a2e;
  --card-bg: #16213e;
  --muted: #0f3460;
  --accent: #00ff88;
  --text-primary: #e94560;
  --text-secondary: #ff6b9d;
  --border-color: #0f3460;
  --shadow: rgba(0, 255, 136, 0.25);
}

body.theme-neon {
  background: linear-gradient(180deg, #1a1a2e, #0f3460);
}

body.theme-neon::before {
  background: linear-gradient(120deg, rgba(0,255,136,0.2), rgba(233,69,96,0.2) 45%, rgba(255,107,157,0.15));
  opacity: 0.6;
}

body.theme-neon .chars,
body.theme-neon .translation {
  color: var(--text-primary);
}

body.theme-tropical {
  --bg: #e8f5e9;
  --card-bg: #ffffff;
  --muted: #558b2f;
  --accent: #66bb6a;
  --text-primary: #2e7d32;
  --text-secondary: #388e3c;
  --border-color: #c8e6c9;
  --shadow: rgba(102, 187, 106, 0.15);
}

body.theme-tropical {
  background: linear-gradient(180deg, #e8f5e9, #c8e6c9);
}

body.theme-tropical::before {
  background: linear-gradient(120deg, rgba(102,187,106,0.3), rgba(156,204,101,0.25) 45%, rgba(220,237,200,0.2));
  opacity: 0.5;
}

body.theme-cherry {
  --bg: #fce4ec;
  --card-bg: #ffffff;
  --muted: #ad1457;
  --accent: #ec407a;
  --text-primary: #880e4f;
  --text-secondary: #c2185b;
  --border-color: #f8bbd0;
  --shadow: rgba(236, 64, 122, 0.15);
}

body.theme-cherry {
  background: linear-gradient(180deg, #fce4ec, #f8bbd0);
}

body.theme-cherry::before {
  background: linear-gradient(120deg, rgba(236,64,122,0.3), rgba(240,98,146,0.25) 45%, rgba(244,143,177,0.2));
  opacity: 0.5;
}

body.theme-aurora {
  --bg: #e8eaf6;
  --card-bg: #ffffff;
  --muted: #5c6bc0;
  --accent: #7e57c2;
  --text-primary: #3949ab;
  --text-secondary: #5e35b1;
  --border-color: #c5cae9;
  --shadow: rgba(126, 87, 194, 0.15);
}

body.theme-aurora {
  background: linear-gradient(180deg, #e8eaf6, #c5cae9);
}

body.theme-aurora::before {
  background: linear-gradient(120deg, rgba(126,87,194,0.3), rgba(92,107,192,0.25) 45%, rgba(121,134,203,0.2));
  opacity: 0.5;
}

/* Disable animations when toggled off */
body.animations-disabled * {
  animation: none !important;
  transition: none !important;
}

body.animations-disabled body::before,
body.animations-disabled body::after,
body.animations-disabled .card::before {
  animation: none !important;
  opacity: 0.35;
  filter: blur(18px);
}

body.animations-disabled .card:hover,
body.animations-disabled .play:hover,
body.animations-disabled .controls button:hover,
body.animations-disabled .theme-toggle:hover {
  transform: none !important;
}

/* Mobile improvements */
@media (max-width: 768px) {
  body {
    padding: 16px;
  }
  
  .card {
    padding: 20px 16px;
  }
  
  .controls-top {
    flex-direction: column;
    align-items: stretch;
  }
  
  .left-controls,
  .right-controls {
    width: 100%;
    justify-content: center;
  }
  
  .theme-controls {
    flex-wrap: wrap;
    gap: 6px;
  }
  
  .theme-btn {
    flex: 1 1 calc(33.333% - 6px);
    min-width: 100px;
    padding: 10px 8px;
    font-size: 12px;
  }
  
  .controls button {
    flex: 1;
    min-height: 44px;
  }
  
  .fav, .animation-toggle {
    flex: 1;
  }
}

@media (max-width: 540px) {
  .chars {
    font-size: 44px;
  }
  
  .translation {
    font-size: 18px;
  }
  
  .theme-btn {
    flex: 1 1 calc(50% - 6px);
    font-size: 11px;
    padding: 8px 6px;
  }
}